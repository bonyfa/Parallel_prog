# Отчет по лабораторной работе №4

## Задание
Написать программу на языке C/C++ для перемножения двух матриц с использованием CUDA для параллельных вычислений.
Исходные данные: файл(ы) содержащие значения исходных матриц.
Выходные данные: файл со значениями результирующей матрицы, время выполнения, объем задачи.
Обязательна автоматизированная верификация результатов вычислений с помощью сторонних библиотек или стороннего ПО (например на Matlab/Python).

## Реализация
На языке C++ реализован класс `Matrix`, обеспечивающий хранение и операции над матрицами, включая чтение/запись из файлов и умножение.

Для ускоренного перемножения матриц используется технология CUDA. Ядро CUDA реализует классический алгоритм перемножения строк на столбцы. Перед вычислениями данные копируются в память устройства, а результат возвращается в оперативную память.

### Алгоритм работы программы:
1. Генерируются две квадратные матрицы размером от 1000x1000 до 5000x5000 со случайными значениями в заданном диапазоне.
2. Матрицы сохраняются в файлы `aN.txt` и `bN.txt`, где `N` — размерность.
3. Выполняется перемножение матриц на GPU с помощью CUDA.
4. Результат записывается в файл `resultN.txt`.
5. Среднее время выполнения рассчитывается по 10 запускам для каждой размерности.
6. Верификация результатов выполняется с использованием Python и библиотеки `numpy`, где сравниваются файлы `resultN.txt` с результатами, полученными через `numpy.dot()`.

### Использование CUDA:
- Для вычислений используется глобальная память (`cudaMalloc` / `cudaMemcpy`).
- Параллелизм организован через сетку блоков и потоков.
- Размер блока (`blockDim`) варьируется (8×8, 16×16, 32×32) для анализа производительности.

## Результаты
Ниже приведены замеры времени выполнения CUDA-умножения матриц с разными размерами блоков:

| Размер матрицы | Блок 8×8 (сек) | Блок 16×16 (сек) | Блок 32×32 (сек) |
|----------------|----------------|------------------|------------------|
| 1000×1000      | 0.05297        | 0.05074          | 0.04835          |
| 2000×2000      | 0.32211        | 0.23854          | 0.24263          |
| 3000×3000      | 0.86725        | 0.46756          | 0.39388          |
| 4000×4000      | 1.52849        | 0.85709          | 0.64497          |
| 5000×5000      | 3.88735        | 1.74804          | 1.14293          |

![График](https://github.com/Darowiin/ParallelProgramming/blob/main/lab_4/image.png)

## Вывод
CUDA-ускорение дало значительный прирост производительности по сравнению с CPU. Оптимальный выбор размера блока является важным фактором производительности: блоки 32×32 показали наилучшие результаты, после 32×32 разница стала слишком незначительной для замера. Также подтверждена корректность CUDA-вычислений с помощью верификации на `numpy`.
